{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/hatim_alouani/chatbot/client/app/components/useUser.tsx"],"sourcesContent":["'use client';\nimport { useState, useEffect } from 'react';\n\nexport default function useUser() {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    async function loadUser() {\n      try {\n        const savedUser = localStorage.getItem('user');\n        if (!savedUser) {\n          setLoading(false);\n          return;\n        }\n\n        const parsedUser = JSON.parse(savedUser);\n        setUser(parsedUser);\n\n        // üåç Dynamically pick the correct backend URL\n        let apiUrl = process.env.NEXT_PUBLIC_API_URL;\n\n        // üîß If running locally, override ngrok with localhost\n        if (typeof window !== 'undefined' && window.location.hostname === 'localhost') {\n          apiUrl = 'http://localhost:3000';\n        }\n\n        const endpoint = `${apiUrl}/api/user-report/${parsedUser.user_id}`;\n        console.log('üåç Fetching report from:', endpoint);\n\n        const res = await fetch(endpoint);\n        const text = await res.text();\n\n        // üß† Handle HTML or non-JSON responses gracefully\n        if (text.trim().startsWith('<')) {\n          console.error('‚ùå Received HTML instead of JSON:', text.slice(0, 120));\n          setLoading(false);\n          return;\n        }\n\n        const data = JSON.parse(text);\n        if (data.ok && data.report?.file_path) {\n          parsedUser.report_url = data.report.file_path;\n          setUser({ ...parsedUser });\n          localStorage.setItem('user', JSON.stringify(parsedUser)); // cache updated user\n        } else {\n          console.warn('‚ö†Ô∏è No report found for this user:', data);\n        }\n      } catch (err) {\n        console.error('Failed to load user/report:', err);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    loadUser();\n  }, []);\n\n  return { user, loading };\n}\n"],"names":[],"mappings":";;;;AAoBqB;AAnBrB;;AADA;;AAGe,SAAS;;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,mLAAQ,EAAC;IACjC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,mLAAQ,EAAC;IAEvC,IAAA,oLAAS;6BAAC;YACR,eAAe;gBACb,IAAI;wBAgCa;oBA/Bf,MAAM,YAAY,aAAa,OAAO,CAAC;oBACvC,IAAI,CAAC,WAAW;wBACd,WAAW;wBACX;oBACF;oBAEA,MAAM,aAAa,KAAK,KAAK,CAAC;oBAC9B,QAAQ;oBAER,8CAA8C;oBAC9C,IAAI;oBAEJ,uDAAuD;oBACvD,IAAI,aAAkB,eAAe,OAAO,QAAQ,CAAC,QAAQ,KAAK,aAAa;wBAC7E,SAAS;oBACX;oBAEA,MAAM,WAAW,AAAC,GAA4B,OAA1B,QAAO,qBAAsC,OAAnB,WAAW,OAAO;oBAChE,QAAQ,GAAG,CAAC,4BAA4B;oBAExC,MAAM,MAAM,MAAM,MAAM;oBACxB,MAAM,OAAO,MAAM,IAAI,IAAI;oBAE3B,kDAAkD;oBAClD,IAAI,KAAK,IAAI,GAAG,UAAU,CAAC,MAAM;wBAC/B,QAAQ,KAAK,CAAC,oCAAoC,KAAK,KAAK,CAAC,GAAG;wBAChE,WAAW;wBACX;oBACF;oBAEA,MAAM,OAAO,KAAK,KAAK,CAAC;oBACxB,IAAI,KAAK,EAAE,MAAI,eAAA,KAAK,MAAM,cAAX,mCAAA,aAAa,SAAS,GAAE;wBACrC,WAAW,UAAU,GAAG,KAAK,MAAM,CAAC,SAAS;wBAC7C,QAAQ;4BAAE,GAAG,UAAU;wBAAC;wBACxB,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC,cAAc,qBAAqB;oBACjF,OAAO;wBACL,QAAQ,IAAI,CAAC,qCAAqC;oBACpD;gBACF,EAAE,OAAO,KAAK;oBACZ,QAAQ,KAAK,CAAC,+BAA+B;gBAC/C,SAAU;oBACR,WAAW;gBACb;YACF;YAEA;QACF;4BAAG,EAAE;IAEL,OAAO;QAAE;QAAM;IAAQ;AACzB;GAxDwB","debugId":null}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///home/hatim_alouani/chatbot/client/app/profile/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport useUser from \"../components/useUser\";\nimport { useRouter } from 'next/navigation';\n\nexport default function Profile() {\n  const { user, loading } = useUser();\n  const router = useRouter();\n\n  useEffect(() => {\n    document.title = 'chatbot | Profile';\n  }, []);\n\n  if (loading)\n    return (\n      <main className=\"flex items-center justify-center h-screen text-gray-600\">\n        Loading profile...\n      </main>\n    );\n\n  if (!user)\n    return (\n      <main className=\"flex items-center justify-center h-screen text-gray-600\">\n        You must log in first.\n        <button onClick={() => router.push('/login')} className=\"ml-2 underline text-blue-600\">\n          Go to Login\n        </button>\n      </main>\n    );\n\n  const status = user.status?.toLowerCase() === 'active' ? 'Active' : user.status;\n\n  return (\n    <main className=\"min-h-screen bg-gradient-to-br from-gray-100 via-indigo-100 to-gray-50 text-gray-800 font-sans flex flex-col\">\n      <section className=\"flex-1 flex items-center justify-center\">\n        <div className=\"bg-white/70 backdrop-blur-lg rounded-2xl shadow-xl p-10 w-[90%] sm:w-[550px] text-center animate-fadeIn\">\n          <h2 className=\"text-3xl font-extrabold mb-2 text-gray-900\">\n            Welcome back, {user.full_name?.split(' ')[0]} üëã\n          </h2>\n          <p className=\"text-gray-600 mb-6\">\n            Here you can review your account details..\n          </p>\n\n          <div className=\"flex flex-col items-center gap-4\">\n            {user.report_url ? (\n              <a\n                href={`${process.env.NEXT_PUBLIC_API_URL}/reports/${user.report_url.split('/').pop()}`}\n                download\n                className=\"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-xl transition-all shadow-md hover:shadow-lg\"\n              >\n                Download Latest Report\n              </a>\n            ) : (\n              <p className=\"text-gray-500\">No report available yet.</p>\n            )}\n          </div>\n        </div>\n      </section>\n\n      <footer className=\"text-center py-6 text-sm text-gray-500\">\n        ¬© 2025 A2X CORP ‚Äî All rights reserved\n      </footer>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;AA+CyB;;AA7CzB;AACA;AACA;;;AAJA;;;;AAMe,SAAS;QAyBP,cAOU;;IA/BzB,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,IAAA,qJAAO;IACjC,MAAM,SAAS,IAAA,4JAAS;IAExB,IAAA,oLAAS;6BAAC;YACR,SAAS,KAAK,GAAG;QACnB;4BAAG,EAAE;IAEL,IAAI,SACF,qBACE,uMAAC;QAAK,WAAU;kBAA0D;;;;;;IAK9E,IAAI,CAAC,MACH,qBACE,uMAAC;QAAK,WAAU;;YAA0D;0BAExE,uMAAC;gBAAO,SAAS,IAAM,OAAO,IAAI,CAAC;gBAAW,WAAU;0BAA+B;;;;;;;;;;;;IAM7F,MAAM,SAAS,EAAA,eAAA,KAAK,MAAM,cAAX,mCAAA,aAAa,WAAW,QAAO,WAAW,WAAW,KAAK,MAAM;IAE/E,qBACE,uMAAC;QAAK,WAAU;;0BACd,uMAAC;gBAAQ,WAAU;0BACjB,cAAA,uMAAC;oBAAI,WAAU;;sCACb,uMAAC;4BAAG,WAAU;;gCAA6C;iCAC1C,kBAAA,KAAK,SAAS,cAAd,sCAAA,gBAAgB,KAAK,CAAC,IAAI,CAAC,EAAE;gCAAC;;;;;;;sCAE/C,uMAAC;4BAAE,WAAU;sCAAqB;;;;;;sCAIlC,uMAAC;4BAAI,WAAU;sCACZ,KAAK,UAAU,iBACd,uMAAC;gCACC,MAAM,AAAC,GAA6C,2FAAX,aAA4C,OAAjC,KAAK,UAAU,CAAC,KAAK,CAAC,KAAK,GAAG;gCAClF,QAAQ;gCACR,WAAU;0CACX;;;;;qDAID,uMAAC;gCAAE,WAAU;0CAAgB;;;;;;;;;;;;;;;;;;;;;;0BAMrC,uMAAC;gBAAO,WAAU;0BAAyC;;;;;;;;;;;;AAKjE;GA3DwB;;QACI,qJAAO;QAClB,4JAAS;;;KAFF","debugId":null}}]
}