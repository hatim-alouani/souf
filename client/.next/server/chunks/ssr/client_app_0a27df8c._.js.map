{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/hatim_alouani/chatbot/client/app/components/useUser.tsx"],"sourcesContent":["'use client';\nimport { useState, useEffect } from 'react';\n\nexport default function useUser() {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    async function loadUser() {\n      try {\n        const savedUser = localStorage.getItem('user');\n        if (!savedUser) {\n          setLoading(false);\n          return;\n        }\n\n        const parsedUser = JSON.parse(savedUser);\n        setUser(parsedUser);\n\n        // üåç Dynamically pick the correct backend URL\n        let apiUrl = process.env.NEXT_PUBLIC_API_URL;\n\n        // üîß If running locally, override ngrok with localhost\n        if (typeof window !== 'undefined' && window.location.hostname === 'localhost') {\n          apiUrl = 'http://localhost:3000';\n        }\n\n        const endpoint = `${apiUrl}/api/user-report/${parsedUser.user_id}`;\n        console.log('üåç Fetching report from:', endpoint);\n\n        const res = await fetch(endpoint);\n        const text = await res.text();\n\n        // üß† Handle HTML or non-JSON responses gracefully\n        if (text.trim().startsWith('<')) {\n          console.error('‚ùå Received HTML instead of JSON:', text.slice(0, 120));\n          setLoading(false);\n          return;\n        }\n\n        const data = JSON.parse(text);\n        if (data.ok && data.report?.file_path) {\n          parsedUser.report_url = data.report.file_path;\n          setUser({ ...parsedUser });\n          localStorage.setItem('user', JSON.stringify(parsedUser)); // cache updated user\n        } else {\n          console.warn('‚ö†Ô∏è No report found for this user:', data);\n        }\n      } catch (err) {\n        console.error('Failed to load user/report:', err);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    loadUser();\n  }, []);\n\n  return { user, loading };\n}\n"],"names":[],"mappings":";;;;AACA;AADA;;AAGe,SAAS;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,2NAAQ,EAAC;IACjC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,2NAAQ,EAAC;IAEvC,IAAA,4NAAS,EAAC;QACR,eAAe;YACb,IAAI;gBACF,MAAM,YAAY,aAAa,OAAO,CAAC;gBACvC,IAAI,CAAC,WAAW;oBACd,WAAW;oBACX;gBACF;gBAEA,MAAM,aAAa,KAAK,KAAK,CAAC;gBAC9B,QAAQ;gBAER,8CAA8C;gBAC9C,IAAI;gBAEJ,uDAAuD;gBACvD,IAAI,gBAAkB,eAAe,OAAO,QAAQ,CAAC,QAAQ,KAAK,aAAa;oBAC7E,SAAS;gBACX;gBAEA,MAAM,WAAW,GAAG,OAAO,iBAAiB,EAAE,WAAW,OAAO,EAAE;gBAClE,QAAQ,GAAG,CAAC,4BAA4B;gBAExC,MAAM,MAAM,MAAM,MAAM;gBACxB,MAAM,OAAO,MAAM,IAAI,IAAI;gBAE3B,kDAAkD;gBAClD,IAAI,KAAK,IAAI,GAAG,UAAU,CAAC,MAAM;oBAC/B,QAAQ,KAAK,CAAC,oCAAoC,KAAK,KAAK,CAAC,GAAG;oBAChE,WAAW;oBACX;gBACF;gBAEA,MAAM,OAAO,KAAK,KAAK,CAAC;gBACxB,IAAI,KAAK,EAAE,IAAI,KAAK,MAAM,EAAE,WAAW;oBACrC,WAAW,UAAU,GAAG,KAAK,MAAM,CAAC,SAAS;oBAC7C,QAAQ;wBAAE,GAAG,UAAU;oBAAC;oBACxB,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC,cAAc,qBAAqB;gBACjF,OAAO;oBACL,QAAQ,IAAI,CAAC,qCAAqC;gBACpD;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,+BAA+B;YAC/C,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG,EAAE;IAEL,OAAO;QAAE;QAAM;IAAQ;AACzB","debugId":null}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///home/hatim_alouani/chatbot/client/app/profile/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport useUser from \"../components/useUser\";\nimport { useRouter } from 'next/navigation';\n\nexport default function Profile() {\n  const { user, loading } = useUser();\n  const router = useRouter();\n\n  useEffect(() => {\n    document.title = 'chatbot | Profile';\n  }, []);\n\n  if (loading)\n    return (\n      <main className=\"flex items-center justify-center h-screen text-gray-600\">\n        Loading profile...\n      </main>\n    );\n\n  if (!user)\n    return (\n      <main className=\"flex items-center justify-center h-screen text-gray-600\">\n        You must log in first.\n        <button onClick={() => router.push('/login')} className=\"ml-2 underline text-blue-600\">\n          Go to Login\n        </button>\n      </main>\n    );\n\n  const status = user.status?.toLowerCase() === 'active' ? 'Active' : user.status;\n\n  return (\n    <main className=\"min-h-screen bg-gradient-to-br from-gray-100 via-indigo-100 to-gray-50 text-gray-800 font-sans flex flex-col\">\n      <section className=\"flex-1 flex items-center justify-center\">\n        <div className=\"bg-white/70 backdrop-blur-lg rounded-2xl shadow-xl p-10 w-[90%] sm:w-[550px] text-center animate-fadeIn\">\n          <h2 className=\"text-3xl font-extrabold mb-2 text-gray-900\">\n            Welcome back, {user.full_name?.split(' ')[0]} üëã\n          </h2>\n          <p className=\"text-gray-600 mb-6\">\n            Here you can review your account details..\n          </p>\n\n          <div className=\"flex flex-col items-center gap-4\">\n            {user.report_url ? (\n              <a\n                href={`${process.env.NEXT_PUBLIC_API_URL}/reports/${user.report_url.split('/').pop()}`}\n                download\n                className=\"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-xl transition-all shadow-md hover:shadow-lg\"\n              >\n                Download Latest Report\n              </a>\n            ) : (\n              <p className=\"text-gray-500\">No report available yet.</p>\n            )}\n          </div>\n        </div>\n      </section>\n\n      <footer className=\"text-center py-6 text-sm text-gray-500\">\n        ¬© 2025 A2X CORP ‚Äî All rights reserved\n      </footer>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,IAAA,kJAAO;IACjC,MAAM,SAAS,IAAA,yJAAS;IAExB,IAAA,4NAAS,EAAC;QACR,SAAS,KAAK,GAAG;IACnB,GAAG,EAAE;IAEL,IAAI,SACF,qBACE,wPAAC;QAAK,WAAU;kBAA0D;;;;;;IAK9E,IAAI,CAAC,MACH,qBACE,wPAAC;QAAK,WAAU;;YAA0D;0BAExE,wPAAC;gBAAO,SAAS,IAAM,OAAO,IAAI,CAAC;gBAAW,WAAU;0BAA+B;;;;;;;;;;;;IAM7F,MAAM,SAAS,KAAK,MAAM,EAAE,kBAAkB,WAAW,WAAW,KAAK,MAAM;IAE/E,qBACE,wPAAC;QAAK,WAAU;;0BACd,wPAAC;gBAAQ,WAAU;0BACjB,cAAA,wPAAC;oBAAI,WAAU;;sCACb,wPAAC;4BAAG,WAAU;;gCAA6C;gCAC1C,KAAK,SAAS,EAAE,MAAM,IAAI,CAAC,EAAE;gCAAC;;;;;;;sCAE/C,wPAAC;4BAAE,WAAU;sCAAqB;;;;;;sCAIlC,wPAAC;4BAAI,WAAU;sCACZ,KAAK,UAAU,iBACd,wPAAC;gCACC,MAAM,sFAAmC,SAAS,EAAE,KAAK,UAAU,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI;gCACtF,QAAQ;gCACR,WAAU;0CACX;;;;;qDAID,wPAAC;gCAAE,WAAU;0CAAgB;;;;;;;;;;;;;;;;;;;;;;0BAMrC,wPAAC;gBAAO,WAAU;0BAAyC;;;;;;;;;;;;AAKjE","debugId":null}}]
}