{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/hatim_alouani/chatbot/client/app/chatbot/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\nexport default function ChatbotPage() {\n  const [question, setQuestion] = useState(\"\");\n  const [response, setResponse] = useState(\"\");\n  const [conversationId, setConversationId] = useState<number | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  async function sendMessage(e: any) {\n    e.preventDefault();\n    setIsLoading(true);\n    setResponse(\"\");\n\n    const token = localStorage.getItem(\"token\");\n\n    const res = await fetch(\"http://localhost:3000/chat\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      },\n      body: JSON.stringify({\n        question,\n        conversationId, // <-- IMPORTANT\n      }),\n    });\n\n    if (!res.ok) {\n      setResponse(\"Error: Unable to reach backend.\");\n      setIsLoading(false);\n      return;\n    }\n\n    // Extract conversation id from header\n    const convHeader = res.headers.get(\"X-Conversation-Id\");\n    if (convHeader) {\n      setConversationId(Number(convHeader));\n    }\n\n    const reader = res.body!.getReader();\n    const decoder = new TextDecoder();\n\n    let accumulated = \"\";\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n\n      const chunk = decoder.decode(value, { stream: true });\n      accumulated += chunk;\n      setResponse(accumulated);\n    }\n\n    setIsLoading(false);\n  }\n\n  return (\n    <div className=\"p-8 max-w-2xl mx-auto\">\n      <h1 className=\"text-2xl font-bold mb-6\">AI Assistant</h1>\n\n      <form onSubmit={sendMessage} className=\"flex gap-3\">\n        <input\n          type=\"text\"\n          className=\"border p-2 flex-1\"\n          placeholder=\"Ask something...\"\n          value={question}\n          onChange={(e) => setQuestion(e.target.value)}\n        />\n        <button\n          className=\"bg-blue-600 text-white px-4 py-2 rounded\"\n          disabled={isLoading}\n        >\n          Send\n        </button>\n      </form>\n\n      <div className=\"mt-6 whitespace-pre-wrap bg-gray-100 p-4 rounded min-h-[200px]\">\n        {response || (isLoading ? \"Thinking...\" : \"\")}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,2NAAQ,EAAC;IACzC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,2NAAQ,EAAC;IACzC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,2NAAQ,EAAgB;IACpE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,2NAAQ,EAAC;IAE3C,eAAe,YAAY,CAAM;QAC/B,EAAE,cAAc;QAChB,aAAa;QACb,YAAY;QAEZ,MAAM,QAAQ,aAAa,OAAO,CAAC;QAEnC,MAAM,MAAM,MAAM,MAAM,8BAA8B;YACpD,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,eAAe,YAAY;YAC7B;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB;gBACA;YACF;QACF;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,YAAY;YACZ,aAAa;YACb;QACF;QAEA,sCAAsC;QACtC,MAAM,aAAa,IAAI,OAAO,CAAC,GAAG,CAAC;QACnC,IAAI,YAAY;YACd,kBAAkB,OAAO;QAC3B;QAEA,MAAM,SAAS,IAAI,IAAI,CAAE,SAAS;QAClC,MAAM,UAAU,IAAI;QAEpB,IAAI,cAAc;QAElB,MAAO,KAAM;YACX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO,IAAI;YACzC,IAAI,MAAM;YAEV,MAAM,QAAQ,QAAQ,MAAM,CAAC,OAAO;gBAAE,QAAQ;YAAK;YACnD,eAAe;YACf,YAAY;QACd;QAEA,aAAa;IACf;IAEA,qBACE,wPAAC;QAAI,WAAU;;0BACb,wPAAC;gBAAG,WAAU;0BAA0B;;;;;;0BAExC,wPAAC;gBAAK,UAAU;gBAAa,WAAU;;kCACrC,wPAAC;wBACC,MAAK;wBACL,WAAU;wBACV,aAAY;wBACZ,OAAO;wBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;kCAE7C,wPAAC;wBACC,WAAU;wBACV,UAAU;kCACX;;;;;;;;;;;;0BAKH,wPAAC;gBAAI,WAAU;0BACZ,YAAY,CAAC,YAAY,gBAAgB,EAAE;;;;;;;;;;;;AAIpD","debugId":null}}]
}